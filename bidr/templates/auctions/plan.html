{% extends 'auctions/auction_base.html' %}

{% load currency %}

{% block auction_inner %}
    <div class="row">
        <div class="col-md-6">
            <table class="table table-hover">
                <thead>
                    <tr>
                        <th>Item Name</th>
                        <th>Minimum Bid</th>
                        <th class="add_object" data-toggle="modal" data-target="#create_item">+ Add New</th>
                    </tr>
                </thead>
                <tbody>
                    {% for item in items %}
                    <tr id="item_{{ item.id }}">
                        <td>
                            {{ item.name }}
                        </td>
                        <td>
                            {{ item.min_price|currency }}
                        </td>
                        <td class="delete">
                            <a onclick="delete_item({{ item.id }})">Delete</a>
                        </td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
        <!-- <div class="col-md-6">
            <table class="table table-hover">
                <thead>
                    <tr>
                        <th>Collection Name</th>
                        <th>Minimum Bid</th>
                        <th class="add_object">+ Add New</th>
                    </tr>
                </thead>
                <tbody>
                    {% for itemcollection in item_collections %}
                    <tr>
                        <td>
                            {{ itemcollection.name }}
                        </td>
                        <td>
                            {{ itemcollection.min_price|currency }}
                        </td>
                        <td style="color: red;">
                            Delete
                        </td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div> -->
    </div>
    
    <div class="modal fade" id="create_item" tabindex="-1" role="dialog" aria-labelledby="create_item" aria-hidden="true">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
                    <h1 class="modal-title" id="myModalLabel">Create Item</h1>
                </div>
                <div class="modal-body">
                    <form name="create_item_form" id="create_item_form" method="POST">
                        {{ form.as_p }}
                        {% csrf_token %}
                    </form>
                </div>
                <div class="modal-footer"></div>
            </div>
        </div>
    </div>
{% endblock %}

{% block extended_scripts %}
{{ block.super }}
    <script type="text/javascript">
        $(document).ready(function () {
            $("#plan_stage").addClass("active");
        });
        
        function delete_item(item_id) {
            $("#item_" + item_id + " a").attr("disabled", "disabled");
            $("#item_" + item_id + " a").css("color", "gray");
            $("#item_" + item_id + " a").css("cursor", "default");
            ajaxPost("{% url 'delete_item' slug=org_slug auction_id=auction.id %}", {"item_id": item_id}, function(response_context) {
                $("#item_" + item_id).remove();
            });
        }
    </script>
{% endblock %}