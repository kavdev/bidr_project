{% extends 'auctions/auction_base.html' %}

{% load currency %}

{% block auction_inner %}
    <div class="row">
        <div class="col-xs-12 text-right">
            <a class="btn btn-default" href="{% url 'start_auction' slug=org_slug auction_id=auction.id %}">Start Auction</a>
        </div>
    </div>
    <div class="row">
        <div class="col-md-6">
            <table class="table table-hover">
                <thead>
                    <tr>
                        <th>Item Name</th>
                        <th>Minimum Bid</th>
                        <th class="add_object"><a data-toggle="modal" data-target="#create_item">+ Add New</a></th>
                    </tr>
                </thead>
                <tbody>
                    {% for item in items %}
                    <tr id="item_{{ item.id }}">
                        <td>
                            {{ item.name }}
                        </td>
                        <td>
                            {{ item.min_price|currency }}
                        </td>
                        <td class="delete">
                            <a onclick="delete_item({{ item.id }})">Delete</a>
                        </td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
        <!-- <div class="col-md-6">
            <table class="table table-hover">
                <thead>
                    <tr>
                        <th>Collection Name</th>
                        <th>Minimum Bid</th>
                        <th class="add_object">+ Add New</th>
                    </tr>
                </thead>
                <tbody>
                    {% for itemcollection in item_collections %}
                    <tr>
                        <td>
                            {{ itemcollection.name }}
                        </td>
                        <td>
                            {{ itemcollection.min_price|currency }}
                        </td>
                        <td style="color: red;">
                            Delete
                        </td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div> -->
    </div>
    
    <div class="modal fade" id="create_item" tabindex="-1" role="dialog" aria-labelledby="create_item" aria-hidden="true">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
                    <h1 class="modal-title" id="create_item">Create Item</h1>
                </div>
                <div class="modal-body text-left embed-responsive embed-responsive-16by9">
                    <iframe class="embed-responsive-item" src="{% url 'create_item' slug=org_slug auction_id=auction.id %}"></iframe>
                </div>
                <div class="modal-footer"></div>
            </div>
        </div>
    </div>
{% endblock %}

{% block extended_scripts %}
{{ block.super }}
    <script type="text/javascript">
        $(document).ready(function () {
            $("#plan_stage").addClass("active");
        });
        
        $('#create_item').on('hidden.bs.modal', function () {
            location.reload();
        });
        
        function delete_item(item_id) {
            var response = confirm('Are you sure you want to delete this item?');
            if (response) {
                $("#item_" + item_id + " a").attr("disabled", "disabled");
                $("#item_" + item_id + " a").css("color", "gray");
                $("#item_" + item_id + " a").css("cursor", "default");
                ajaxPost("{% url 'delete_item' slug=org_slug auction_id=auction.id %}", {"item_id": item_id}, function(response_context) {
                    $("#item_" + item_id).remove();
                });
            } else {
                return false;
            }
        }
    </script>
{% endblock %}